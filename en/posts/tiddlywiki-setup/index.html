<!doctype html><html lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=content-language content="en"><meta name=author content="Sine"><meta name=description content="TiddlyWiki TiddlyWiki is a note-taking app for managing complex information. It has two features that I really like:
Philosophy of Tiddlers I think people have two purposes for taking notes. One is to deepen the understanding of knowledge by means of the output process of taking notes, and the other is to facilitate reuse of this knowledge in the future. The former is a temporary role, but the notes for this purpose need not be saved, while the latter is very important, and a relatively complete form is needed to organize the knowledge for later reference."><meta name=keywords content="blog,developer,personal"><meta name=twitter:card content="summary"><meta name=twitter:title content="Setup of Personal Non-linear Notebook TiddlyWiki Server"><meta name=twitter:description content="TiddlyWiki TiddlyWiki is a note-taking app for managing complex information. It has two features that I really like:
Philosophy of Tiddlers I think people have two purposes for taking notes. One is to deepen the understanding of knowledge by means of the output process of taking notes, and the other is to facilitate reuse of this knowledge in the future. The former is a temporary role, but the notes for this purpose need not be saved, while the latter is very important, and a relatively complete form is needed to organize the knowledge for later reference."><meta property="og:title" content="Setup of Personal Non-linear Notebook TiddlyWiki Server"><meta property="og:description" content="TiddlyWiki TiddlyWiki is a note-taking app for managing complex information. It has two features that I really like:
Philosophy of Tiddlers I think people have two purposes for taking notes. One is to deepen the understanding of knowledge by means of the output process of taking notes, and the other is to facilitate reuse of this knowledge in the future. The former is a temporary role, but the notes for this purpose need not be saved, while the latter is very important, and a relatively complete form is needed to organize the knowledge for later reference."><meta property="og:type" content="article"><meta property="og:url" content="https://ssine.ink/en/posts/tiddlywiki-setup/"><meta property="article:published_time" content="2019-08-13T00:00:00+00:00"><meta property="article:modified_time" content="2019-08-13T00:00:00+00:00"><title>Setup of Personal Non-linear Notebook TiddlyWiki Server · Sine's Site</title><link rel=canonical href=https://ssine.ink/en/posts/tiddlywiki-setup/><link rel=preconnect href=https://fonts.gstatic.com><link href="https://fonts.googleapis.com/css?family=Lato:400,700%7CMerriweather:300,700%7CSource+Code+Pro:400,700&display=swap" rel=stylesheet><link rel=preload href="https://ssine.ink/fonts/forkawesome-webfont.woff2?v=1.1.7" as=font type=font/woff2 crossorigin><link rel=stylesheet href=https://ssine.ink/css/coder.min.a050bb9724f6a498b574acf612d6d523bc68756ddc62579923710a8542947c52.css integrity="sha256-oFC7lyT2pJi1dKz2EtbVI7xodW3cYleZI3EKhUKUfFI=" crossorigin=anonymous media=screen><link rel=stylesheet href=https://ssine.ink/css/coder-dark.min.126ad3988d46bdae6217a11105b53c9662bca05f39d42d3c0fb366919d334620.css integrity="sha256-EmrTmI1Gva5iF6ERBbU8lmK8oF851C08D7NmkZ0zRiA=" crossorigin=anonymous media=screen><link rel=icon type=image/png href=https://ssine.ink/favicon.ico sizes=32x32><link rel=icon type=image/png href=https://ssine.ink/favicon.ico sizes=16x16><link rel=apple-touch-icon href=https://ssine.ink/images/apple-touch-icon.png><link rel=apple-touch-icon sizes=180x180 href=https://ssine.ink/images/apple-touch-icon.png><meta name=generator content="Hugo 0.74.1"></head><body class=colorscheme-auto><div class=float-container><a id=dark-mode-toggle class=colorscheme-toggle><i class="fa fa-adjust fa-fw" aria-hidden=true></i></a></div><main class=wrapper><nav class=navigation><section class=container><a class=navigation-title href=https://ssine.ink/en>Sine's Site</a>
<input type=checkbox id=menu-toggle>
<label class="menu-button float-right" for=menu-toggle><i class="fa fa-bars fa-fw" aria-hidden=true></i></label><ul class=navigation-list><li class=navigation-item><a class=navigation-link href=https://ssine.ink/en/posts/>Blog</a></li><li class=navigation-item><a class=navigation-link href=https://kiwi.ssine.cc>Wiki</a></li><li class=navigation-item><a class=navigation-link href=https://ssine.ink/en/gallery>Gallery</a></li><li class=navigation-item><a class=navigation-link href=https://ssine.ink/en/projects/>Projects</a></li><li class="navigation-item menu-separator"><span>|</span></li><li class=navigation-item><a href=https://ssine.ink/posts/tiddlywiki-setup/>中文</a></li></ul></section></nav><div class=content><section class="container post"><article><header><div class=post-title><h1 class=title>Setup of Personal Non-linear Notebook TiddlyWiki Server</h1></div><div class=post-meta><div class=date><span class=posted-on><i class="fa fa-calendar" aria-hidden=true></i><time datetime=2019-08-13T00:00:00Z>August 13, 2019</time></span>
<span class=reading-time><i class="fa fa-clock-o" aria-hidden=true></i>10-minute read</span></div></div></header><div><h1 id=tiddlywiki>TiddlyWiki</h1><p><a href=https://tiddlywiki.com/>TiddlyWiki</a> is a note-taking app for managing complex information. It has two features that I really like:</p><h2 id=philosophy-of-tiddlers>Philosophy of Tiddlers</h2><p>I think people have two purposes for taking notes. One is to deepen the understanding of knowledge by means of the output process of taking notes, and the other is to facilitate reuse of this knowledge in the future. The former is a temporary role, but the notes for this purpose need not be saved, while the latter is very important, and a relatively complete form is needed to organize the knowledge for later reference. TiddlyWiki uses Tiddler to record meaningful and indivisible information, and to express deeper information through the connection between them, so as to record and retrieve knowledge at any level. As its official website says:</p><blockquote><p>The purpose of recording and organising information is so that it can be used again. The value of recorded information is directly proportional to the ease with which it can be re-used.</p><p>The philosophy of tiddlers is that we maximise the possibilities for re-use by slicing information up into the smallest semantically meaningful units with rich modelling of relationships between them. Then we use aggregation and composition to weave the fragments together to present narrative stories.</p><p>TiddlyWiki aspires to provide an algebra for tiddlers, a concise way of expressing and exploring the relationships between items of information.</p></blockquote><h2 id=self-contained>Self-contained</h2><p>TiddlyWiki is a complete application with two main manifestations, one is a separate single html file, and the other is a directory containing many Tiddler files and meta information. Single html document includes all the logic and data, program directory mode requires node tiddlywikias a server. The program itself is open source, and it gives all the data management rights to the user, you only need a browser to access the data. Unlike other online services, even after a few decades &mdash; as long as Web technology is still there, you can continue to use the entire application.</p><h1 id=derver-deployment>Derver Deployment</h1><p>TiddlyWiki can be used in a variety of ways, as a single html, combined with TiddlyDesktop for saving, and using the pages service on the public network, or using a server program to manage a directory. In the actual use process, the single html experience is not good, because html does not have permission to overwrite the data when saving the data, can only be saved by downloading new files or using other applications, and will also be downloaded when accessing on the network. The file is too big a problem. The following mainly describes how to deploy a directory through the server serve.</p><h2 id=nodejs-environment>NodeJS Environment</h2><p>TiddlyWiki is written by js. The required runtime environment is node. Install node under ubuntu:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=color:#75715e># install package manager</span>
apt install npm
<span style=color:#75715e># instal node version manager</span>
npm install -g n
<span style=color:#75715e># update nodejs to stable version</span>
n stable
<span style=color:#75715e># change the registry</span>
npm config set registry http://registry.npm.taobao.org/
</code></pre></div><h2 id=tiddlywiki-server>TiddlyWiki Server</h2><p>After installing node, use the following command to install the TiddlyWiki server program:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>sudo npm install -g tiddlywiki
</code></pre></div><h3 id=create-a-new-tiddlywiki-folder>Create a New TiddlyWiki Folder</h3><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>tiddlywiki mywiki --init server
</code></pre></div><p>A new directory called mywiki will be created in the current directory to store data for all wikis. use</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>tiddlywiki mywiki --listen
</code></pre></div><p>The server side of TiddlyWiki will be launched and accessible in the browser.</p><p>For a detailed explanation of the instructions, refer to the <a href=https://tiddlywiki.com/#WebServer>official website</a> . There is also a more detailed explanation in the official <a href=https://github.com/Jermolene/TiddlyWiki5#installing-tiddlywiki-on-nodejs>Github repository</a> .</p><h3 id=verification>Verification</h3><p>One problem with using the server and putting it on the public network is that anyone can modify your wiki. We hope that users who can log in with their username and password can modify it, but users who are not logged in can only view it. <a href=https://tiddlywiki.com/#WebServer%20Authorization>This feature</a> was added in <a href=https://tiddlywiki.com/#Release%205.1.18>version 5.1.18</a> . Create a new file, users.csv, containing the username and password of all users, in the form:</p><pre><code class=language-csv data-lang=csv>username,password
jane,do3
andy,sm1th
roger,m00re
</code></pre><p>When the server is started, add <code>--listen credentials="/path/to/users.csv" "readers=(anon)" writers=jane,andy,roger</code> can achieve the goal of anonymous view, and user modify.</p><h3 id=nginx-https>Nginx, HTTPS</h3><p>If you want to deploy TiddlyWiki in a subdirectory (that is, not listening to port 80 by TiddlyWiki), you need to use Nginx as a reverse proxy to forward the request to the TiddlyWiki server. Let&rsquo;s take my service as an example. My homepage is ssine.cc. If I want TiddlyWiki to run on the wiki.ssine.cc domain name, I need to forward the wiki.ssine.cc request from Nginx to the port where TiddlyWiki is located.</p><p>Modified <code>/etc/nginx/sites-available/wiki.ssine.cc.conf</code> ：</p><pre><code class=language-conf data-lang=conf>server {
    listen 80;
    listen [::]:80;

    server_name wiki.ssine.cc;
    root /var/www/ssine.cc;

    index index.html;
    location / {
            try_files $uri $uri/ =404;
    }
}
</code></pre><p>Then restart Nginx and activate this route:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>sudo ln -s /etc/nginx/sites-available/wiki.ssine.cc.conf /etc/nginx/sites-enabled/wiki.ssine.cc.conf
sudo nginx -t
sudo systemctl stop nginx
sudo systemctl start nginx
sudo systemctl status nginx
</code></pre></div><p>Obtain an HTTPS certificate:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>sudo certbot --rsa-key-size <span style=color:#ae81ff>4096</span> --nginx
</code></pre></div><p>Then modify the Nginx settings to enable the reverse proxy:</p><pre><code class=language-conf data-lang=conf>server {
    server_name wiki.ssine.cc;
    root /var/www/ssine.cc;

    index index.html;

    location / {
        proxy_pass http://localhost:1004/;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;

        add_header Strict-Transport-Security &quot;max-age=31536000; includeSubDomains; preload&quot;;
        client_max_body_size 0;

        access_log /var/log/nginx/wiki.access.log;
        error_log /var/log/nginx/wiki.error.log;
    }

    listen [::]:443 ssl http2; # managed by Certbot
    listen 443 ssl http2; # managed by Certbot
    ssl_certificate /etc/letsencrypt/live/nextcloud.dennisnotes.com/fullchain.pem; # managed by Certbot
    ssl_certificate_key /etc/letsencrypt/live/nextcloud.dennisnotes.com/privkey.pem; # managed by Certbot
    ssl_trusted_certificate /etc/letsencrypt/live/nextcloud.dennisnotes.com/chain.pem;
    include /etc/nginx/snippets/ssl.conf;
}
</code></pre><p>Then repeat the above steps, restart Nginx, you can forward the traffic of wiki.ssine.cc to the local 1004 port.</p><p>Finally, start TiddlyWiki Server on port 1004, the directory is tw :</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>tiddlywiki tw --listen host<span style=color:#f92672>=</span>127.0.0.1 port<span style=color:#f92672>=</span><span style=color:#ae81ff>1004</span> credentials<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;/path/to/users.csv&#34;</span> writers<span style=color:#f92672>=</span>sine,jill
</code></pre></div><p>You can also use the nohup directive to have the service run in the background:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>nohup tiddlywiki tw --listen host<span style=color:#f92672>=</span>127.0.0.1 port<span style=color:#f92672>=</span><span style=color:#ae81ff>1004</span> credentials<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;/path/to/users.csv&#34;</span> writers<span style=color:#f92672>=</span>sine,jill &gt; log.txt 2&gt;&amp;<span style=color:#ae81ff>1</span> &amp;
</code></pre></div><h1 id=settings>Settings</h1><p>Here are some of the adjustments to TiddlyWiki in everyday use.</p><h2 id=add-css>Add CSS</h2><p>The way to add your own CSS is simple. Create a new Tiddler, set Type to text/css, and add a tag of $:/tags/Stylesheet to take effect.</p><h3 id=centering-story-river>Centering Story River</h3><p>A list of all Tiddlers is displayed, called Story River, and a column showing the title is called Side Bar. There are two layout modes: the fixed story river and the fixed sidebar, but the widescreen display will be very biased if the story river is fixed. If the sidebar is fixed, the story river is too wide to read a line. So manually modify the CSS so that the story river width is fixed and centered, and the sidebar is on the right side of the story river:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-css data-lang=css>@<span style=color:#66d9ef>media</span> {
   {
    <span style=color:#960050;background-color:#1e0010>$:</span> <span style=color:#960050;background-color:#1e0010>/themes/tiddlywiki/vanilla/metrics/sidebarbreakpoint</span>;
  }
}
<span style=color:#f92672>)</span> {
  <span style=color:#960050;background-color:#1e0010>html</span> <span style=color:#960050;background-color:#1e0010>.tc-page-container</span> <span style=color:#960050;background-color:#1e0010>{</span>
    <span style=color:#66d9ef>text-align</span>: <span style=color:#66d9ef>center</span>;
  }

  <span style=color:#f92672>html</span> .<span style=color:#a6e22e>tc-story-river</span> {
    <span style=color:#66d9ef>position</span>: <span style=color:#66d9ef>relative</span>;
    <span style=color:#66d9ef>width</span>: <span style=color:#ae81ff>712</span><span style=color:#66d9ef>px</span>;
    <span style=color:#75715e>/*width:1300px;*/</span>
    <span style=color:#66d9ef>padding-right</span>: <span style=color:#ae81ff>0</span><span style=color:#66d9ef>px</span>;
    <span style=color:#66d9ef>padding-left</span>: <span style=color:#ae81ff>0</span><span style=color:#66d9ef>px</span>;
    <span style=color:#66d9ef>margin</span>: <span style=color:#ae81ff>0</span> <span style=color:#66d9ef>auto</span>;
    <span style=color:#66d9ef>text-align</span>: <span style=color:#66d9ef>left</span>;
  }

  <span style=color:#f92672>html</span> .<span style=color:#a6e22e>tc-sidebar-scrollable</span> {
    <span style=color:#66d9ef>text-align</span>: <span style=color:#66d9ef>left</span>;
    <span style=color:#66d9ef>left</span>: <span style=color:#ae81ff>50</span><span style=color:#66d9ef>%</span>;
    <span style=color:#66d9ef>right</span>: <span style=color:#ae81ff>0</span>;
    <span style=color:#66d9ef>margin-left</span>: <span style=color:#ae81ff>350</span><span style=color:#66d9ef>px</span>;
  }

  <span style=color:#f92672>html</span> .<span style=color:#a6e22e>tc-tiddler-frame</span> {
    <span style=color:#66d9ef>width</span>: <span style=color:#ae81ff>100</span><span style=color:#66d9ef>%</span>;
  }
<span style=color:#960050;background-color:#1e0010>}</span>
</code></pre></div><h3 id=background-color-of-selected-text>Background Color of Selected Text</h3><p>Change the background of the selected text to black, nothing else but feeling cooler 😎 .</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-css data-lang=css>::<span style=color:#a6e22e>selection</span> {
  <span style=color:#66d9ef>background</span>: <span style=color:#ae81ff>#333</span>;
  <span style=color:#66d9ef>color</span>: <span style=color:#ae81ff>#fff</span>;
}

::<span style=color:#a6e22e>-moz-selection</span> {
  <span style=color:#66d9ef>background</span>: <span style=color:#ae81ff>#333</span>;
  <span style=color:#66d9ef>color</span>: <span style=color:#ae81ff>#fff</span>;
}

::<span style=color:#a6e22e>-webkit-selection</span> {
  <span style=color:#66d9ef>background</span>: <span style=color:#ae81ff>#333</span>;
  <span style=color:#66d9ef>color</span>: <span style=color:#ae81ff>#fff</span>;
}
</code></pre></div><h3 id=tiddler-content-styling>Tiddler Content Styling</h3><p>Modify the indentation of the list, the default indentation is too much, looking uncomfortable:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-css data-lang=css><span style=color:#f92672>ul</span> {
  <span style=color:#66d9ef>padding-left</span>: <span style=color:#ae81ff>0</span><span style=color:#66d9ef>px</span>;
  <span style=color:#66d9ef>margin-left</span>: <span style=color:#ae81ff>25</span><span style=color:#66d9ef>px</span>;
}

<span style=color:#f92672>ol</span> {
  <span style=color:#66d9ef>padding-left</span>: <span style=color:#ae81ff>0</span><span style=color:#66d9ef>px</span>;
  <span style=color:#66d9ef>margin-left</span>: <span style=color:#ae81ff>25</span><span style=color:#66d9ef>px</span>;
}
</code></pre></div><p>Text spacing fine-tuning, heading style, horizontal line style:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-css data-lang=css>.<span style=color:#a6e22e>tc-story-river</span> {
  <span style=color:#66d9ef>word-spacing</span>: <span style=color:#ae81ff>0.1</span><span style=color:#66d9ef>em</span>;
}

.<span style=color:#a6e22e>tc-story-river</span> <span style=color:#f92672>h1</span> {
  <span style=color:#66d9ef>text-align</span>: <span style=color:#66d9ef>center</span>;
}

.<span style=color:#a6e22e>tc-story-river</span> <span style=color:#f92672>h2</span> {
  <span style=color:#66d9ef>text-align</span>: <span style=color:#66d9ef>center</span>;
}

.<span style=color:#a6e22e>tc-story-river</span> <span style=color:#f92672>h3</span> {
  <span style=color:#66d9ef>text-decoration</span>: <span style=color:#66d9ef>underline</span>;
}

<span style=color:#f92672>hr</span> {
  <span style=color:#66d9ef>margin</span>: <span style=color:#ae81ff>0</span> <span style=color:#66d9ef>auto</span>;
  <span style=color:#66d9ef>border</span>: <span style=color:#ae81ff>0</span>;
  <span style=color:#66d9ef>height</span>: <span style=color:#ae81ff>1</span><span style=color:#66d9ef>px</span>;
  <span style=color:#66d9ef>background</span>: <span style=color:#ae81ff>#333</span>;
  <span style=color:#66d9ef>background-image</span>: linear-gradient(<span style=color:#66d9ef>to</span> <span style=color:#66d9ef>right</span>, <span style=color:#ae81ff>#333</span>, <span style=color:#ae81ff>#a349a4</span>, <span style=color:#ae81ff>#333</span>);
}
</code></pre></div><h3 id=new-font>New Font</h3><p>Many good-looking fonts are not safe, which means that there may not be on the client. In order to ensure the display effect, font-face is used to add fonts. When there is no font on the client, it will be downloaded at the address declared by font-face.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-css data-lang=css>@<span style=color:#66d9ef>font-face</span> {
  <span style=color:#f92672>font-family</span><span style=color:#f92672>:</span> <span style=color:#f92672>Constantia</span><span style=color:#f92672>;</span>
  <span style=color:#f92672>src</span><span style=color:#f92672>:</span> <span style=color:#f92672>url</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;https://example.com/fonts/constan.ttf&#34;</span><span style=color:#f92672>);</span>
}

@<span style=color:#66d9ef>font-face</span> {
  <span style=color:#f92672>font-family</span><span style=color:#f92672>:</span> <span style=color:#f92672>Constantia</span><span style=color:#f92672>;</span>
  <span style=color:#f92672>src</span><span style=color:#f92672>:</span> <span style=color:#f92672>url</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;https://example.com/fonts/constanb.ttf&#34;</span><span style=color:#f92672>);</span>
  <span style=color:#f92672>font-weight</span><span style=color:#f92672>:</span> <span style=color:#f92672>bold</span><span style=color:#f92672>;</span>
}

@<span style=color:#66d9ef>font-face</span> {
  <span style=color:#f92672>font-family</span><span style=color:#f92672>:</span> <span style=color:#f92672>Constantia</span><span style=color:#f92672>;</span>
  <span style=color:#f92672>src</span><span style=color:#f92672>:</span> <span style=color:#f92672>url</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;https://example.com/fonts/constani.ttf&#34;</span><span style=color:#f92672>);</span>
  <span style=color:#f92672>font-style</span><span style=color:#f92672>:</span> <span style=color:#f92672>italic</span><span style=color:#f92672>;</span>
}
</code></pre></div><p>This will allow you to use Constantia fonts in your settings.</p><h2 id=plugins>Plugins</h2><p>The main function of the plugin is to handle the rendering of Tiddler text, such as rendering the latex math formula, or converting the flow of the text description into svg. The way to install the plugin is very simple, drag its link to the TiddlyWiki interface and import it.</p><h3 id=latex>Latex</h3><p>Although the latex parser commonly used on the Web side is Mathjax, the more complete plugin on TiddlyWiki is only KaTeX. I also spent a lot of effort to port the Mathjax plugin that only supports single page mode to the server. Later, I think I still use KaTeX. It’s too much of a hassle to maintain a plugin yourself.</p><h3 id=mermaid>Mermaid</h3><p>I want to draw a flowchart here. There is already a plugin called Mermaid.js but the layout is very ugly. It also took a while. Later, when I was writing a formal language automaton note, I wanted to be able to display Tiddler&rsquo;s links on nodes and edges, and I did a lot of Ugly Hack. Now that I have forgotten the grammar of that time, the code I wrote is a bit too lazy to look at. It is also a trade-off, but it has a lot of functions, but it needs to remember more grammar to maintain some things, or it can be simple in function but simple in people. I plan to port a viz.js later, because the Graphviz layout is great, but the js file is a bit large and should be carefully considered. However, the main factor in whether or not to use this build tool is whether it needs to be modified in the future, otherwise it will be fine to upload the image locally and upload it.</p><h2 id=macro>Macro</h2><p>TiddlyWiki also supports macro definitions, which can be used to expand a macro (similar to a function) into a piece of text. The way to create a macro is to create a new Tiddler, set the Type to application/javascript, and add filed: module-type, value: macro at the bottom Add a new field.</p><p>Use when calling in other Tiddlers use <code>&lt;&lt;macro-name param1 param2 ...>></code> .</p><h3 id=embedding-svg>Embedding SVG</h3><p>Embedding svg into html is cool, because the text in the image can even be selected, because it is often used as a macro:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript>(<span style=color:#66d9ef>function</span> () {
  <span style=color:#75715e>/*jslint node: true, browser: true */</span>
  <span style=color:#75715e>/*global $tw: false */</span>
  <span style=color:#e6db74>&#34;use strict&#34;</span>;

  <span style=color:#75715e>/*
</span><span style=color:#75715e>Information about this macro
</span><span style=color:#75715e>*/</span>

  <span style=color:#a6e22e>exports</span>.<span style=color:#a6e22e>name</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;svg&#34;</span>;

  <span style=color:#a6e22e>exports</span>.<span style=color:#a6e22e>params</span> <span style=color:#f92672>=</span> [{ <span style=color:#a6e22e>name</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;src&#34;</span> }, { <span style=color:#a6e22e>name</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;width&#34;</span> }];

  <span style=color:#75715e>/*
</span><span style=color:#75715e>Run the macro
</span><span style=color:#75715e>*/</span>
  <span style=color:#a6e22e>exports</span>.<span style=color:#a6e22e>run</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>function</span> (<span style=color:#a6e22e>src</span>, <span style=color:#a6e22e>width</span>) {
    <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>width</span>[<span style=color:#a6e22e>width</span>.<span style=color:#a6e22e>length</span> <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>] <span style=color:#f92672>==</span> <span style=color:#e6db74>&#34;%&#34;</span>)
      <span style=color:#66d9ef>return</span> (
        <span style=color:#e6db74>&#39;&lt;center&gt;&lt;embed src=&#34;&#39;</span> <span style=color:#f92672>+</span>
        <span style=color:#a6e22e>src</span> <span style=color:#f92672>+</span>
        <span style=color:#e6db74>&#39;&#34; style=&#34;width:&#39;</span> <span style=color:#f92672>+</span>
        <span style=color:#a6e22e>width</span> <span style=color:#f92672>+</span>
        <span style=color:#e6db74>&#39;;&#34; type=&#34;image/svg+xml&#34; /&gt;&lt;/center&gt;&#39;</span>
      );
    <span style=color:#66d9ef>else</span>
      <span style=color:#66d9ef>return</span> (
        <span style=color:#e6db74>&#39;&lt;center&gt;&lt;embed src=&#34;&#39;</span> <span style=color:#f92672>+</span>
        <span style=color:#a6e22e>src</span> <span style=color:#f92672>+</span>
        <span style=color:#e6db74>&#39;&#34; style=&#34;width:&#39;</span> <span style=color:#f92672>+</span>
        <span style=color:#a6e22e>width</span> <span style=color:#f92672>+</span>
        <span style=color:#e6db74>&#39;px;&#34; type=&#34;image/svg+xml&#34; /&gt;&lt;/center&gt;&#39;</span>
      );
  };
})();
</code></pre></div><p>The argument is the url and width of svg, which is used like this:</p><pre><code class=language-tid data-lang=tid>&lt;&lt;svg &quot;https://example.com/8086general-regs.svg&quot; 450&gt;&gt;
</code></pre><h3 id=prevent-image-caching>Prevent image caching</h3><p>Some external images will be cached for a long time. If you want to re-request the image every time you open the page, you can use the following macro:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript>(<span style=color:#66d9ef>function</span> () {
  <span style=color:#75715e>/*jslint node: true, browser: true */</span>
  <span style=color:#75715e>/*global $tw: false */</span>
  <span style=color:#e6db74>&#34;use strict&#34;</span>;

  <span style=color:#75715e>/*
</span><span style=color:#75715e>Information about this macro
</span><span style=color:#75715e>*/</span>

  <span style=color:#a6e22e>exports</span>.<span style=color:#a6e22e>name</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;nc-img&#34;</span>;

  <span style=color:#a6e22e>exports</span>.<span style=color:#a6e22e>params</span> <span style=color:#f92672>=</span> [{ <span style=color:#a6e22e>name</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;url&#34;</span> }];

  <span style=color:#75715e>/*
</span><span style=color:#75715e>Run the macro
</span><span style=color:#75715e>*/</span>
  <span style=color:#a6e22e>exports</span>.<span style=color:#a6e22e>run</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>function</span> (<span style=color:#a6e22e>url</span>) {
    <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>url</span> <span style=color:#f92672>+</span> <span style=color:#e6db74>&#34;?&#34;</span> <span style=color:#f92672>+</span> <span style=color:#66d9ef>new</span> Date().<span style=color:#a6e22e>getTime</span>();
  };
})();
</code></pre></div><p>The principle is to add <code>? + random number</code> to the image address, so the browser will consider another image to re-request.</p><p>How to use (the only place to use is to update the Project Euler&rsquo;s badge XD):</p><pre><code class=language-tid data-lang=tid>&lt;img src=&lt;&lt;nc-img url:&quot;https://projecteuler.net/profile/sineLiu.png&quot;&gt;&gt;/&gt;
</code></pre></div><footer></footer></article><script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script><script id=MathJax-script async src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js></script><script>MathJax={tex:{inlineMath:[['$','$'],['\\(','\\)']],processEscapes:true,processEnvironments:true},options:{skipHtmlTags:['script','noscript','style','textarea','pre']}};</script></section></div><footer class=footer><section class=container><p>© 2016 - 2023 Sine Liu</p></section></footer></main><script src=https://ssine.ink/js/dark-mode.min.0213e1773e6d1c5a644f847c67a6f8abac49a3776e2976f6008038af8c5b76a1.js></script><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-127064931-1','auto');ga('send','pageview');}</script></body></html>